{
    "namespaces": {},
    "dashboards": {
        "SecurityOperatorDashboard": {
            "DashboardId": "SecurityOperatorDashboard",
            "Name": "Security Lake Operator Dashboard",
            "ThemeArn": "arn:aws:quicksight::aws:theme/MIDNIGHT",
            "Definition": {
                "DataSetIdentifierDeclarations": [
                    {
                        "Identifier": "vpc-flow-data",
                        "DataSetArn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/vpc-flow-dataset"
                    },
                    {
                        "Identifier": "Cloudtrail New",
                        "DataSetArn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/cloudtrail-dataset"
                    },
                    {
                        "Identifier": "SH New",
                        "DataSetArn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/sh-findings-dataset"
                    },
                    {
                        "Identifier": "R53 New",
                        "DataSetArn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/r53-dataset"
                    },
                    {
                        "Identifier": "sl-ag-production",
                        "DataSetArn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/sl-ag-dataset"
                    }
                ],
                "Sheets": [
                    {
                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                        "Name": "Threat Hunting",
                        "FilterControls": [
                            {
                                "DateTimePicker": {
                                    "FilterControlId": "d77ecef9-e046-43df-8ac4-043a29b9b36f",
                                    "Title": "Date between",
                                    "SourceFilterId": "d4248a49-e22c-44e0-bb7f-68a6580d1034",
                                    "Type": "DATE_RANGE"
                                }
                            },
                            {
                                "Dropdown": {
                                    "FilterControlId": "eb9637e3-88ed-4062-aaec-77ae27e77642",
                                    "Title": "api_operation equals",
                                    "SourceFilterId": "e492cd99-6481-468f-b1f8-64fa3c6df625",
                                    "DisplayOptions": {
                                        "SelectAllOptions": {
                                            "Visibility": "VISIBLE"
                                        },
                                        "TitleOptions": {
                                            "Visibility": "VISIBLE",
                                            "FontConfiguration": {}
                                        }
                                    },
                                    "Type": "MULTI_SELECT"
                                }
                            }
                        ],
                        "Visuals": [
                            {
                                "SankeyDiagramVisual": {
                                    "VisualId": "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131",
                                    "Title": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "Subtitle": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "ChartConfiguration": {
                                        "FieldWells": {
                                            "SankeyDiagramAggregatedFieldWells": {
                                                "Source": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "71f17e04-70dd-4664-8628-1ee781887821.account_uid.1.1681912104567",
                                                            "Column": {
                                                                "DataSetIdentifier": "vpc-flow-data",
                                                                "ColumnName": "account_uid"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "Destination": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "71f17e04-70dd-4664-8628-1ee781887821.src_endpoint_ip.1.1681912165206",
                                                            "Column": {
                                                                "DataSetIdentifier": "vpc-flow-data",
                                                                "ColumnName": "src_endpoint_ip"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "Weight": []
                                            }
                                        },
                                        "SortConfiguration": {
                                            "SourceItemsLimit": {
                                                "ItemsLimit": 10,
                                                "OtherCategories": "EXCLUDE"
                                            },
                                            "DestinationItemsLimit": {
                                                "ItemsLimit": 10,
                                                "OtherCategories": "EXCLUDE"
                                            }
                                        },
                                        "DataLabels": {
                                            "Visibility": "VISIBLE",
                                            "Overlap": "DISABLE_OVERLAP"
                                        }
                                    },
                                    "Actions": []
                                }
                            },
                            {
                                "ComboChartVisual": {
                                    "VisualId": "SecurityOperatorDashboard_ef68e453-c098-4cb8-be29-455474658600",
                                    "Title": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "Subtitle": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "ChartConfiguration": {
                                        "FieldWells": {
                                            "ComboChartAggregatedFieldWells": {
                                                "Category": [
                                                    {
                                                        "DateDimensionField": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.Date.1.1681911769139",
                                                            "Column": {
                                                                "DataSetIdentifier": "Cloudtrail New",
                                                                "ColumnName": "Date"
                                                            },
                                                            "HierarchyId": "6d6d9e43-d986-4b50-b052-62d925e33cd1"
                                                        }
                                                    }
                                                ],
                                                "BarValues": [],
                                                "Colors": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.account_uid.1.1681911778433",
                                                            "Column": {
                                                                "DataSetIdentifier": "Cloudtrail New",
                                                                "ColumnName": "account_uid"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "LineValues": []
                                            }
                                        },
                                        "SortConfiguration": {
                                            "CategorySort": [
                                                {
                                                    "FieldSort": {
                                                        "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.Date.1.1681911769139",
                                                        "Direction": "ASC"
                                                    }
                                                }
                                            ],
                                            "CategoryItemsLimit": {
                                                "OtherCategories": "INCLUDE"
                                            },
                                            "ColorItemsLimit": {
                                                "OtherCategories": "INCLUDE"
                                            }
                                        },
                                        "BarsArrangement": "STACKED",
                                        "BarDataLabels": {
                                            "Visibility": "HIDDEN",
                                            "Overlap": "DISABLE_OVERLAP"
                                        },
                                        "LineDataLabels": {
                                            "Overlap": "DISABLE_OVERLAP"
                                        }
                                    },
                                    "Actions": [],
                                    "ColumnHierarchies": [
                                        {
                                            "DateTimeHierarchy": {
                                                "HierarchyId": "6d6d9e43-d986-4b50-b052-62d925e33cd1",
                                                "DrillDownFilters": []
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "SankeyDiagramVisual": {
                                    "VisualId": "SecurityOperatorDashboard_cdef8db9-c811-44b3-8c00-285586923ca3",
                                    "Title": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "Subtitle": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "ChartConfiguration": {
                                        "FieldWells": {
                                            "SankeyDiagramAggregatedFieldWells": {
                                                "Source": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "71f17e04-70dd-4664-8628-1ee781887821.src_endpoint_ip.1.1681912123791",
                                                            "Column": {
                                                                "DataSetIdentifier": "vpc-flow-data",
                                                                "ColumnName": "src_endpoint_ip"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "Destination": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "71f17e04-70dd-4664-8628-1ee781887821.dst_endpoint_ip.1.1681912197130",
                                                            "Column": {
                                                                "DataSetIdentifier": "vpc-flow-data",
                                                                "ColumnName": "dst_endpoint_ip"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "Weight": []
                                            }
                                        },
                                        "SortConfiguration": {
                                            "SourceItemsLimit": {
                                                "ItemsLimit": 10,
                                                "OtherCategories": "EXCLUDE"
                                            },
                                            "DestinationItemsLimit": {
                                                "ItemsLimit": 10,
                                                "OtherCategories": "EXCLUDE"
                                            }
                                        },
                                        "DataLabels": {
                                            "Visibility": "VISIBLE",
                                            "Overlap": "DISABLE_OVERLAP"
                                        }
                                    },
                                    "Actions": []
                                }
                            },
                            {
                                "SankeyDiagramVisual": {
                                    "VisualId": "SecurityOperatorDashboard_5025adcd-a21f-4571-a9b4-1d24f2cd08b6",
                                    "Title": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "Subtitle": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "ChartConfiguration": {
                                        "FieldWells": {
                                            "SankeyDiagramAggregatedFieldWells": {
                                                "Source": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "0ddebb26-5cb8-4a96-ad8d-1f833d297908.srcIp.0.1681911139646",
                                                            "Column": {
                                                                "DataSetIdentifier": "R53 New",
                                                                "ColumnName": "srcIp"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "Destination": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "0ddebb26-5cb8-4a96-ad8d-1f833d297908.queryHostname.1.1681911151462",
                                                            "Column": {
                                                                "DataSetIdentifier": "R53 New",
                                                                "ColumnName": "queryHostname"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "Weight": []
                                            }
                                        },
                                        "SortConfiguration": {
                                            "SourceItemsLimit": {
                                                "ItemsLimit": 10
                                            },
                                            "DestinationItemsLimit": {
                                                "ItemsLimit": 10
                                            }
                                        },
                                        "DataLabels": {
                                            "Visibility": "VISIBLE",
                                            "Overlap": "DISABLE_OVERLAP"
                                        }
                                    },
                                    "Actions": []
                                }
                            },
                            {
                                "ComboChartVisual": {
                                    "VisualId": "SecurityOperatorDashboard_dc683e38-efd8-4936-a404-895d234449e8",
                                    "Title": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "Subtitle": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "ChartConfiguration": {
                                        "FieldWells": {
                                            "ComboChartAggregatedFieldWells": {
                                                "Category": [
                                                    {
                                                        "DateDimensionField": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.Date.1.1681911277174",
                                                            "Column": {
                                                                "DataSetIdentifier": "Cloudtrail New",
                                                                "ColumnName": "Date"
                                                            },
                                                            "HierarchyId": "4b5c9a32-4872-4ae9-9d61-1ec24065e343"
                                                        }
                                                    }
                                                ],
                                                "BarValues": [],
                                                "Colors": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.api_operation.0.1681911250831",
                                                            "Column": {
                                                                "DataSetIdentifier": "Cloudtrail New",
                                                                "ColumnName": "api_operation"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "LineValues": []
                                            }
                                        },
                                        "SortConfiguration": {
                                            "CategorySort": [
                                                {
                                                    "FieldSort": {
                                                        "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.Date.1.1681911277174",
                                                        "Direction": "ASC"
                                                    }
                                                }
                                            ],
                                            "CategoryItemsLimit": {
                                                "OtherCategories": "INCLUDE"
                                            },
                                            "ColorItemsLimit": {
                                                "OtherCategories": "INCLUDE"
                                            }
                                        },
                                        "BarsArrangement": "STACKED",
                                        "BarDataLabels": {
                                            "Visibility": "HIDDEN",
                                            "Overlap": "DISABLE_OVERLAP"
                                        },
                                        "LineDataLabels": {
                                            "Overlap": "DISABLE_OVERLAP"
                                        }
                                    },
                                    "Actions": [],
                                    "ColumnHierarchies": [
                                        {
                                            "DateTimeHierarchy": {
                                                "HierarchyId": "4b5c9a32-4872-4ae9-9d61-1ec24065e343",
                                                "DrillDownFilters": []
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "BarChartVisual": {
                                    "VisualId": "SecurityOperatorDashboard_2f854b3e-d62b-49e7-ad58-29ad883ef98e",
                                    "Title": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "Subtitle": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "ChartConfiguration": {
                                        "FieldWells": {
                                            "BarChartAggregatedFieldWells": {
                                                "Category": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.account_uid.0.1681911722867",
                                                            "Column": {
                                                                "DataSetIdentifier": "Cloudtrail New",
                                                                "ColumnName": "account_uid"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "Values": [
                                                    {
                                                        "CategoricalMeasureField": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.api_operation.2.1681912419771",
                                                            "Column": {
                                                                "DataSetIdentifier": "Cloudtrail New",
                                                                "ColumnName": "api_operation"
                                                            },
                                                            "AggregationFunction": "COUNT"
                                                        }
                                                    }
                                                ],
                                                "Colors": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.api_operation.1.1681911731752",
                                                            "Column": {
                                                                "DataSetIdentifier": "Cloudtrail New",
                                                                "ColumnName": "api_operation"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        "SortConfiguration": {
                                            "CategorySort": [
                                                {
                                                    "FieldSort": {
                                                        "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.api_operation.2.1681912419771",
                                                        "Direction": "DESC"
                                                    }
                                                }
                                            ],
                                            "CategoryItemsLimit": {
                                                "OtherCategories": "EXCLUDE"
                                            },
                                            "ColorItemsLimit": {
                                                "OtherCategories": "EXCLUDE"
                                            },
                                            "SmallMultiplesLimitConfiguration": {
                                                "OtherCategories": "EXCLUDE"
                                            }
                                        },
                                        "Orientation": "HORIZONTAL",
                                        "BarsArrangement": "STACKED",
                                        "DataLabels": {
                                            "Visibility": "HIDDEN",
                                            "Overlap": "DISABLE_OVERLAP"
                                        },
                                        "Tooltip": {
                                            "TooltipVisibility": "VISIBLE",
                                            "SelectedTooltipType": "BASIC",
                                            "FieldBasedTooltip": {
                                                "AggregationVisibility": "HIDDEN",
                                                "TooltipTitleType": "PRIMARY_VALUE",
                                                "TooltipFields": [
                                                    {
                                                        "FieldTooltipItem": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.account_uid.0.1681911722867",
                                                            "Visibility": "VISIBLE"
                                                        }
                                                    },
                                                    {
                                                        "FieldTooltipItem": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.api_operation.1.1681911731752",
                                                            "Visibility": "VISIBLE"
                                                        }
                                                    },
                                                    {
                                                        "FieldTooltipItem": {
                                                            "FieldId": "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490.api_operation.1.1681911731752",
                                                            "Visibility": "VISIBLE"
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    },
                                    "Actions": [],
                                    "ColumnHierarchies": []
                                }
                            },
                            {
                                "SankeyDiagramVisual": {
                                    "VisualId": "SecurityOperatorDashboard_eb4b7715-4fe9-4bef-bffc-a34528b6c873",
                                    "Title": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "Subtitle": {
                                        "Visibility": "VISIBLE"
                                    },
                                    "ChartConfiguration": {
                                        "FieldWells": {
                                            "SankeyDiagramAggregatedFieldWells": {
                                                "Source": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "0ddebb26-5cb8-4a96-ad8d-1f833d297908.accountId.1.1681912481544",
                                                            "Column": {
                                                                "DataSetIdentifier": "R53 New",
                                                                "ColumnName": "accountId"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "Destination": [
                                                    {
                                                        "CategoricalDimensionField": {
                                                            "FieldId": "0ddebb26-5cb8-4a96-ad8d-1f833d297908.srcIp.0.1681912481544",
                                                            "Column": {
                                                                "DataSetIdentifier": "R53 New",
                                                                "ColumnName": "srcIp"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "Weight": []
                                            }
                                        },
                                        "SortConfiguration": {
                                            "SourceItemsLimit": {
                                                "ItemsLimit": 10
                                            },
                                            "DestinationItemsLimit": {
                                                "ItemsLimit": 10
                                            }
                                        },
                                        "DataLabels": {
                                            "Visibility": "VISIBLE",
                                            "Overlap": "DISABLE_OVERLAP"
                                        }
                                    },
                                    "Actions": []
                                }
                            }
                        ],
                        "TextBoxes": [
                            {
                                "SheetTextBoxId": "SecurityOperatorDashboard_1af5c574-f3cd-426b-9247-908fc99c31c8",
                                "Content": "<text-box>\n  <block align=\"center\">\n    <inline font-size=\"20px\">\n      <b>Account Connectivity</b>\n    </inline>\n  </block>\n  <br/>\n  <block align=\"center\"/>\n</text-box>"
                            },
                            {
                                "SheetTextBoxId": "SecurityOperatorDashboard_cecb79f2-6b61-4f71-ba33-fcce0beaf3f2",
                                "Content": "<text-box>\n  <block align=\"center\">\n    <inline font-size=\"20px\">\n      <b>API Analytics</b>\n    </inline>\n  </block>\n</text-box>"
                            },
                            {
                                "SheetTextBoxId": "SecurityOperatorDashboard_99fc5637-fa60-4744-812e-c141a666c82f",
                                "Content": "<text-box>\n  <block align=\"center\">\n    <inline font-size=\"20px\">\n      <b>Rejected Traffic</b>\n    </inline>\n  </block>\n</text-box>"
                            }
                        ],
                        "Layouts": [
                            {
                                "Configuration": {
                                    "GridLayout": {
                                        "Elements": [
                                            {
                                                "ElementId": "SecurityOperatorDashboard_cecb79f2-6b61-4f71-ba33-fcce0beaf3f2",
                                                "ElementType": "TEXT_BOX",
                                                "ColumnIndex": 0,
                                                "ColumnSpan": 36,
                                                "RowIndex": 0,
                                                "RowSpan": 1
                                            },
                                            {
                                                "ElementId": "SecurityOperatorDashboard_2f854b3e-d62b-49e7-ad58-29ad883ef98e",
                                                "ElementType": "VISUAL",
                                                "ColumnIndex": 0,
                                                "ColumnSpan": 36,
                                                "RowIndex": 1,
                                                "RowSpan": 12
                                            },
                                            {
                                                "ElementId": "SecurityOperatorDashboard_dc683e38-efd8-4936-a404-895d234449e8",
                                                "ElementType": "VISUAL",
                                                "ColumnIndex": 0,
                                                "ColumnSpan": 36,
                                                "RowIndex": 13,
                                                "RowSpan": 12
                                            },
                                            {
                                                "ElementId": "SecurityOperatorDashboard_ef68e453-c098-4cb8-be29-455474658600",
                                                "ElementType": "VISUAL",
                                                "ColumnIndex": 0,
                                                "ColumnSpan": 36,
                                                "RowIndex": 25,
                                                "RowSpan": 12
                                            },
                                            {
                                                "ElementId": "SecurityOperatorDashboard_1af5c574-f3cd-426b-9247-908fc99c31c8",
                                                "ElementType": "TEXT_BOX",
                                                "ColumnIndex": 0,
                                                "ColumnSpan": 36,
                                                "RowIndex": 37,
                                                "RowSpan": 1
                                            },
                                            {
                                                "ElementId": "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131",
                                                "ElementType": "VISUAL",
                                                "ColumnIndex": 0,
                                                "ColumnSpan": 18,
                                                "RowIndex": 38,
                                                "RowSpan": 12
                                            },
                                            {
                                                "ElementId": "SecurityOperatorDashboard_eb4b7715-4fe9-4bef-bffc-a34528b6c873",
                                                "ElementType": "VISUAL",
                                                "ColumnIndex": 18,
                                                "ColumnSpan": 18,
                                                "RowIndex": 38,
                                                "RowSpan": 12
                                            },
                                            {
                                                "ElementId": "SecurityOperatorDashboard_99fc5637-fa60-4744-812e-c141a666c82f",
                                                "ElementType": "TEXT_BOX",
                                                "ColumnIndex": 0,
                                                "ColumnSpan": 36,
                                                "RowIndex": 50,
                                                "RowSpan": 1
                                            },
                                            {
                                                "ElementId": "SecurityOperatorDashboard_5025adcd-a21f-4571-a9b4-1d24f2cd08b6",
                                                "ElementType": "VISUAL",
                                                "ColumnIndex": 0,
                                                "ColumnSpan": 18,
                                                "RowIndex": 51,
                                                "RowSpan": 12
                                            },
                                            {
                                                "ElementId": "SecurityOperatorDashboard_cdef8db9-c811-44b3-8c00-285586923ca3",
                                                "ElementType": "VISUAL",
                                                "ColumnIndex": 18,
                                                "ColumnSpan": 18,
                                                "RowIndex": 51,
                                                "RowSpan": 12
                                            }
                                        ],
                                        "CanvasSizeOptions": {
                                            "ScreenCanvasSizeOptions": {
                                                "ResizeOption": "FIXED",
                                                "OptimizedViewPortWidth": "1600px"
                                            }
                                        }
                                    }
                                }
                            }
                        ],
                        "SheetControlLayouts": [
                            {
                                "Configuration": {
                                    "GridLayout": {
                                        "Elements": [
                                            {
                                                "ElementId": "d77ecef9-e046-43df-8ac4-043a29b9b36f",
                                                "ElementType": "FILTER_CONTROL",
                                                "ColumnSpan": 3,
                                                "RowSpan": 1
                                            },
                                            {
                                                "ElementId": "eb9637e3-88ed-4062-aaec-77ae27e77642",
                                                "ElementType": "FILTER_CONTROL",
                                                "ColumnSpan": 2,
                                                "RowSpan": 1
                                            }
                                        ]
                                    }
                                }
                            }
                        ],
                        "ContentType": "INTERACTIVE"
                    }
                ],
                "CalculatedFields": [],
                "ParameterDeclarations": [],
                "FilterGroups": [
                    {
                        "FilterGroupId": "6b19fd30-d680-4175-a4fa-cc7ea197ce96",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "c5f550f2-9759-455d-b4e8-24a057885066",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "activity_name"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "CategoryValues": [
                                                "Refused"
                                            ]
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_cdef8db9-c811-44b3-8c00-285586923ca3"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    },
                    {
                        "FilterGroupId": "424add20-1aac-4275-9058-5a1130451298",
                        "Filters": [
                            {
                                "TimeRangeFilter": {
                                    "FilterId": "d4248a49-e22c-44e0-bb7f-68a6580d1034",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "Date"
                                    },
                                    "IncludeMinimum": true,
                                    "IncludeMaximum": true,
                                    "RangeMinimumValue": {
                                        "RollingDate": {
                                            "Expression": "addDateTime(-1, 'WK', truncDate('WK', now()))"
                                        }
                                    },
                                    "RangeMaximumValue": {
                                        "RollingDate": {
                                            "Expression": "truncDate('DD', now())"
                                        }
                                    },
                                    "NullOption": "NON_NULLS_ONLY",
                                    "TimeGranularity": "DAY"
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "ALL_VISUALS"
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "ALL_DATASETS"
                    },
                    {
                        "FilterGroupId": "aef4e03e-24e6-4d4f-8503-64d9b866e788",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "7c3950fd-112d-4e76-8ac9-57f3ceef4547",
                                    "Column": {
                                        "DataSetIdentifier": "R53 New",
                                        "ColumnName": "activityName"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "CategoryValues": [
                                                "Unresolved"
                                            ]
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_5025adcd-a21f-4571-a9b4-1d24f2cd08b6"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    },
                    {
                        "FilterGroupId": "9d862e32-e123-49b1-82a5-cacc24db0ecb",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "e492cd99-6481-468f-b1f8-64fa3c6df625",
                                    "Column": {
                                        "DataSetIdentifier": "Cloudtrail New",
                                        "ColumnName": "api_operation"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "SelectAllOptions": "FILTER_ALL_VALUES"
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "ALL_VISUALS"
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "ALL_DATASETS"
                    },
                    {
                        "FilterGroupId": "eaa3aa46-a134-4556-bc49-e3bf1acaefc0",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "31fef44e-ce8e-4c89-b842-f424df9d73df",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "account_uid"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "SelectAllOptions": "FILTER_ALL_VALUES"
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    },
                    {
                        "FilterGroupId": "ee55007e-494b-4c14-81f1-99bc8b228320",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "68cba237-3f01-4d21-a08b-c308f46d3f21",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "cloud_region"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "SelectAllOptions": "FILTER_ALL_VALUES"
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    },
                    {
                        "FilterGroupId": "6b333ba1-d19e-4086-a996-a72ea904262a",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "306d7cae-351e-48a1-b73b-f0ed47c832f9",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "activity_name"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "SelectAllOptions": "FILTER_ALL_VALUES"
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    },
                    {
                        "FilterGroupId": "5fe0fab2-2195-4d5e-8d94-dae69659e806",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "88d7b465-485c-450c-b374-aa3f3ea5365d",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "dst_endpoint_ip"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "SelectAllOptions": "FILTER_ALL_VALUES"
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    },
                    {
                        "FilterGroupId": "8c9e0211-9168-487b-bdbf-a29f146bff6d",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "bee5e289-7267-4c9d-b691-fe73e461192e",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "src_endpoint_ip"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "SelectAllOptions": "FILTER_ALL_VALUES"
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    },
                    {
                        "FilterGroupId": "8f1b112c-c25c-4ad3-9bc1-a33dbc85c21d",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "879f1f23-451a-4690-8751-d8ece3ff9a58",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "dst_endpoint_port"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "SelectAllOptions": "FILTER_ALL_VALUES"
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    },
                    {
                        "FilterGroupId": "ae76df2f-debe-491c-97d5-cd3b18cbf6dd",
                        "Filters": [
                            {
                                "CategoryFilter": {
                                    "FilterId": "7e9b15fc-b67d-41ea-9e5c-30d52f9b0d42",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "src_endpoint_port"
                                    },
                                    "Configuration": {
                                        "FilterListConfiguration": {
                                            "MatchOperator": "CONTAINS",
                                            "SelectAllOptions": "FILTER_ALL_VALUES"
                                        }
                                    }
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    },
                    {
                        "FilterGroupId": "af97ff27-6d88-49c7-ad49-74afe4ce0bb3",
                        "Filters": [
                            {
                                "TimeRangeFilter": {
                                    "FilterId": "01223952-940c-4f0f-8eb0-a117a4422a65",
                                    "Column": {
                                        "DataSetIdentifier": "vpc-flow-data",
                                        "ColumnName": "Date"
                                    },
                                    "IncludeMinimum": true,
                                    "IncludeMaximum": true,
                                    "RangeMinimumValue": {
                                        "StaticValue": "2022-10-31T20:00:00-04:00"
                                    },
                                    "RangeMaximumValue": {
                                        "StaticValue": "2023-04-28T10:20:00-04:00"
                                    },
                                    "NullOption": "NON_NULLS_ONLY",
                                    "TimeGranularity": "MINUTE"
                                }
                            }
                        ],
                        "ScopeConfiguration": {
                            "SelectedSheets": {
                                "SheetVisualScopingConfigurations": [
                                    {
                                        "SheetId": "SecurityOperatorDashboard_4bea718f-d96f-4ad6-8da2-6f6438aa0056",
                                        "Scope": "SELECTED_VISUALS",
                                        "VisualIds": [
                                            "SecurityOperatorDashboard_47a82dff-8e7b-42e0-87ff-c873c3897131"
                                        ]
                                    }
                                ]
                            }
                        },
                        "Status": "ENABLED",
                        "CrossDataset": "SINGLE_DATASET"
                    }
                ],
                "ColumnConfigurations": [
                    {
                        "Column": {
                            "DataSetIdentifier": "R53 New",
                            "ColumnName": "region"
                        },
                        "Role": "DIMENSION"
                    }
                ],
                "AnalysisDefaults": {
                    "DefaultNewSheetConfiguration": {
                        "InteractiveLayoutConfiguration": {
                            "Grid": {
                                "CanvasSizeOptions": {
                                    "ScreenCanvasSizeOptions": {
                                        "ResizeOption": "FIXED",
                                        "OptimizedViewPortWidth": "1600px"
                                    }
                                }
                            }
                        },
                        "SheetContentType": "INTERACTIVE"
                    }
                }
            },
            "DashboardPublishOptions": {
                "AdHocFilteringOption": {
                    "AvailabilityStatus": "DISABLED"
                },
                "ExportToCSVOption": {
                    "AvailabilityStatus": "ENABLED"
                },
                "SheetControlsOption": {
                    "VisibilityState": "COLLAPSED"
                },
                "SheetLayoutElementMaximizationOption": {
                    "AvailabilityStatus": "ENABLED"
                },
                "VisualMenuOption": {
                    "AvailabilityStatus": "ENABLED"
                },
                "VisualAxisSortOption": {
                    "AvailabilityStatus": "ENABLED"
                },
                "ExportWithHiddenFieldsOption": {
                    "AvailabilityStatus": "DISABLED"
                },
                "DataPointDrillUpDownOption": {
                    "AvailabilityStatus": "ENABLED"
                },
                "DataPointMenuLabelOption": {
                    "AvailabilityStatus": "ENABLED"
                },
                "DataPointTooltipOption": {
                    "AvailabilityStatus": "ENABLED"
                }
            },
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDashboard",
                        "quicksight:ListDashboardVersions",
                        "quicksight:QueryDashboard"
                    ]
                }
            ]
        }
    },
    "analyses": {},
    "templates": {},
    "datasets": {
        "vpc-flow-dataset": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/vpc-flow-dataset",
            "DataSetId": "vpc-flow-dataset",
            "Name": "vpc-flow-data",
            "LastUpdatedTime": "2023-05-09T00:14:34.285000-04:00",
            "PhysicalTableMap": {
                "ddc9824c-8cbf-4ec0-9be0-ef0ea481eed3": {
                    "CustomSql": {
                        "DataSourceArn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/vpc-flow-datasource",
                        "Name": "New custom SQL",
                        "SqlQuery": "SELECT \r\n    cast(from_unixtime(time/1000) as timestamp) as Date,\r\n    cloud.region as cloud_region,\r\n    cloud.account_uid as account_uid,\r\n    severity,\r\n    severity_id,\r\n    activity_name,\r\n    type_name,\r\n    cast(src_endpoint.port AS varchar) as src_endpoint_port,\r\n    src_endpoint.ip AS src_endpoint_ip,\r\n    src_endpoint.subnet_uid AS src_endpoint_subnet_uid,\r\n    src_endpoint.vpc_uid as src_vpc_uid,\r\n    cast(dst_endpoint.port AS varchar) as dst_endpoint_port,\r\n    dst_endpoint.ip AS dst_endpoint_ip,\r\n    dst_endpoint.subnet_uid AS dst_endpoint_subnet_uid,\r\n    dst_endpoint.vpc_uid as dst_vpc_uid,\r\n    connection_info.direction AS connection_info_direction,\r\n    connection_info.boundary AS connection_info_boundary, \r\n    connection_info.tcp_flags as tcp_flags,\r\n    traffic.packets AS traffic_packets,\r\n    traffic.bytes AS traffic_bytes\r\nFROM \"amazon_security_lake_glue_db_<aws-security-lake-region>\".\"amazon_security_lake_table_<aws-security-lake-region>_vpc_flow_1_0_1_0\"\r\nWHERE eventDay >= cast(date_format(current_timestamp - INTERVAL '6' month, '%Y%m%d%H') as varchar)",
                        "Columns": [
                            {
                                "Name": "Date",
                                "Type": "DATETIME"
                            },
                            {
                                "Name": "cloud_region",
                                "Type": "STRING"
                            },
                            {
                                "Name": "account_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "severity",
                                "Type": "STRING"
                            },
                            {
                                "Name": "severity_id",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "activity_name",
                                "Type": "STRING"
                            },
                            {
                                "Name": "type_name",
                                "Type": "STRING"
                            },
                            {
                                "Name": "src_endpoint_port",
                                "Type": "STRING"
                            },
                            {
                                "Name": "src_endpoint_ip",
                                "Type": "STRING"
                            },
                            {
                                "Name": "src_endpoint_subnet_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "src_vpc_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "dst_endpoint_port",
                                "Type": "STRING"
                            },
                            {
                                "Name": "dst_endpoint_ip",
                                "Type": "STRING"
                            },
                            {
                                "Name": "dst_endpoint_subnet_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "dst_vpc_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "connection_info_direction",
                                "Type": "STRING"
                            },
                            {
                                "Name": "connection_info_boundary",
                                "Type": "STRING"
                            },
                            {
                                "Name": "tcp_flags",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "traffic_packets",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "traffic_bytes",
                                "Type": "INTEGER"
                            }
                        ]
                    }
                }
            },
            "LogicalTableMap": {
                "71f17e04-70dd-4664-8628-1ee781887821": {
                    "Alias": "New custom SQL",
                    "DataTransforms": [
                        {
                            "TagColumnOperation": {
                                "ColumnName": "cloud_region",
                                "Tags": [
                                    {
                                        "ColumnGeographicRole": "STATE"
                                    }
                                ]
                            }
                        },
                        {
                            "ProjectOperation": {
                                "ProjectedColumns": [
                                    "Date",
                                    "cloud_region",
                                    "account_uid",
                                    "severity",
                                    "severity_id",
                                    "activity_name",
                                    "type_name",
                                    "src_endpoint_port",
                                    "src_endpoint_ip",
                                    "src_endpoint_subnet_uid",
                                    "src_vpc_uid",
                                    "dst_endpoint_port",
                                    "dst_endpoint_ip",
                                    "dst_endpoint_subnet_uid",
                                    "dst_vpc_uid",
                                    "connection_info_direction",
                                    "connection_info_boundary",
                                    "tcp_flags",
                                    "traffic_packets",
                                    "traffic_bytes"
                                ]
                            }
                        }
                    ],
                    "Source": {
                        "PhysicalTableId": "ddc9824c-8cbf-4ec0-9be0-ef0ea481eed3"
                    }
                }
            },
            "OutputColumns": [
                {
                    "Name": "Date",
                    "Type": "DATETIME"
                },
                {
                    "Name": "cloud_region",
                    "Type": "STRING"
                },
                {
                    "Name": "account_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "severity",
                    "Type": "STRING"
                },
                {
                    "Name": "severity_id",
                    "Type": "INTEGER"
                },
                {
                    "Name": "activity_name",
                    "Type": "STRING"
                },
                {
                    "Name": "type_name",
                    "Type": "STRING"
                },
                {
                    "Name": "src_endpoint_port",
                    "Type": "STRING"
                },
                {
                    "Name": "src_endpoint_ip",
                    "Type": "STRING"
                },
                {
                    "Name": "src_endpoint_subnet_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "src_vpc_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "dst_endpoint_port",
                    "Type": "STRING"
                },
                {
                    "Name": "dst_endpoint_ip",
                    "Type": "STRING"
                },
                {
                    "Name": "dst_endpoint_subnet_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "dst_vpc_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "connection_info_direction",
                    "Type": "STRING"
                },
                {
                    "Name": "connection_info_boundary",
                    "Type": "STRING"
                },
                {
                    "Name": "tcp_flags",
                    "Type": "INTEGER"
                },
                {
                    "Name": "traffic_packets",
                    "Type": "INTEGER"
                },
                {
                    "Name": "traffic_bytes",
                    "Type": "INTEGER"
                }
            ],
            "ImportMode": "SPICE",
            "ConsumedSpiceCapacityInBytes": 853130,
            "FieldFolders": {},
            "DataSetUsageConfiguration": {
                "DisableUseAsDirectQuerySource": false,
                "DisableUseAsImportedSource": false
            },
            "RefreshSchedules": [
                {
                    "ScheduleId": "87be4414-eb99-4e37-93b1-589ca483e6eb",
                    "ScheduleFrequency": {
                        "Interval": "DAILY",
                        "Timezone": "America/New_York",
                        "TimeOfTheDay": "23:59"
                    },
                    "StartAfterDateTime": "2023-04-21T15:58:49-04:00",
                    "RefreshType": "FULL_REFRESH"
                }
            ],
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSet",
                        "quicksight:DescribeDataSetPermissions",
                        "quicksight:PassDataSet",
                        "quicksight:DescribeIngestion",
                        "quicksight:ListIngestions"
                    ]
                }
            ]
        },
        "cloudtrail-dataset": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/cloudtrail-dataset",
            "DataSetId": "cloudtrail-dataset",
            "Name": "cloudtrail-data",
            "LastUpdatedTime": "2023-05-09T00:19:21.605000-04:00",
            "PhysicalTableMap": {
                "38dcdd2c-a830-4ca0-be5b-d318dd809351": {
                    "CustomSql": {
                        "DataSourceArn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/cloudtrail-datasource",
                        "Name": "New custom SQL",
                        "SqlQuery": "SELECT \r\n    cast(from_unixtime(time/1000) as timestamp) as Date,\r\n    cloud.region,\r\n    http_request.user_agent,\r\n\r\n    api.response.error as api_response_error,\r\n    api.response.message as api_response_message,\r\n    api.operation as api_operation,\r\n    api.request.uid as api_request_uid,\r\n    api.service.name as api_service_name,\r\n    \r\n    src_endpoint.uid as src_endpoint_uid,\r\n    src_endpoint.ip as src_endpoint_ip,\r\n    src_endpoint.domain as src_endpoint_domain,\r\n\t\r\n    actor.user.type as identity_user_type,\r\n    actor.user.name as identity_user_name,\r\n    actor.user.uid as identity_user_uid,\r\n    actor.user.uuid as identity_user_uuid,\r\n    actor.user.credential_uid as identity_user_credential_uid,\r\n    actor.user.account_uid,\r\n    actor.session.created_time as identity_session_created_time,\r\n    actor.session.mfa as identity_session_mfa,\r\n    actor.session.issuer as identity_session_issuer,\r\n    actor.idp.name as identity_idp,\r\n\t\r\n\tunmapped['eventCategory'] as unmapped_event_category,\r\n    unmapped['responseElement'] as unmapped_response_element,\r\n    unmapped['requestParameters'] as unmapped_request_parameters,\r\n    unmapped['recipientAccountId'] as unmapped_recipient_account_id,\r\n    unmapped['eventType'] as unmapped_event_type,\r\n    unmapped['managementEvent'] as unmapped_management_event,\r\n    unmapped['readOnly'] as unmapped_read_only,\r\n    \r\n    json_extract(unmapped['additionalEventData'], '$.SignatureVersion') as unmapped_additional_signature_version,\r\n    json_extract(unmapped['additionalEventData'], '$.CipherSuite') as unmapped_additional_cipher_suit,\r\n    json_extract(unmapped['additionalEventData'], '$.AuthenticationMethod') as unmapped_additional_auth_method,\r\n    json_extract(unmapped['additionalEventData'], '$.SSEApplied') as unmapped_additional_sse_applied,\r\n    cast(json_extract(unmapped['additionalEventData'], '$.bytesTransferredIn') as double) as unmapped_additional_bytes_tx_in,\r\n    cast(json_extract(unmapped['additionalEventData'], '$.bytesTransferredOut') as double) as unmapped_additional_bytes_tx_out,\r\n    json_extract(unmapped['requestParameters'], '$.bucketName') as unmapped_additional_bucket_name,\r\n    json_extract(unmapped['requestParameters'], '$.Host') as unmapped_additional_host,\r\n    json_extract(unmapped['requestParameters'], '$.key') as unmapped_additional_key,\r\n    json_extract(unmapped['requestParameters'], '$.functionName') as unmapped_additional_function_name,\r\n    json_extract(unmapped['requestParameters'], '$.invocationType') as unmapped_additional_invocation_type,\r\n    json_extract(unmapped['requestParameters'], '$.logType') as unmapped_additional_log_type,\r\n    json_extract(unmapped['requestParameters'], '$.roleArn') as unmapped_additional_role_arn,\r\n    json_extract(unmapped['requestParameters'], '$.roleSessionName') as unmapped_additional_session_name,\r\n    json_extract(unmapped['requestParameters'], '$.durationSeconds') as unmapped_additional_duration_sec,\r\n    json_extract(unmapped['requestParameters'], '$.encryptionAlgorithm') as unmapped_additional_encryption_algorithm,\r\n    json_extract(unmapped['requestParameters'], '$.encryptionContext.aws:lambda:FunctionArn') as unmapped_additional_encryption_context\r\n\r\nFROM amazon_security_lake_glue_db_<aws-security-lake-region>.amazon_security_lake_table_<aws-security-lake-region>_cloud_trail_mgmt_1_0_1_0\r\nWHERE  eventDay >= cast(date_format(current_timestamp - INTERVAL '1' month, '%Y%m%d%H') as varchar)",
                        "Columns": [
                            {
                                "Name": "Date",
                                "Type": "DATETIME"
                            },
                            {
                                "Name": "region",
                                "Type": "STRING"
                            },
                            {
                                "Name": "user_agent",
                                "Type": "STRING"
                            },
                            {
                                "Name": "api_response_error",
                                "Type": "STRING"
                            },
                            {
                                "Name": "api_response_message",
                                "Type": "STRING"
                            },
                            {
                                "Name": "api_operation",
                                "Type": "STRING"
                            },
                            {
                                "Name": "api_request_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "api_service_name",
                                "Type": "STRING"
                            },
                            {
                                "Name": "src_endpoint_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "src_endpoint_ip",
                                "Type": "STRING"
                            },
                            {
                                "Name": "src_endpoint_domain",
                                "Type": "STRING"
                            },
                            {
                                "Name": "identity_user_type",
                                "Type": "STRING"
                            },
                            {
                                "Name": "identity_user_name",
                                "Type": "STRING"
                            },
                            {
                                "Name": "identity_user_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "identity_user_uuid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "identity_user_credential_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "account_uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "identity_session_created_time",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "identity_session_mfa",
                                "Type": "BOOLEAN"
                            },
                            {
                                "Name": "identity_session_issuer",
                                "Type": "STRING"
                            },
                            {
                                "Name": "identity_idp",
                                "Type": "STRING"
                            },
                            {
                                "Name": "unmapped_event_category",
                                "Type": "STRING"
                            },
                            {
                                "Name": "unmapped_response_element",
                                "Type": "STRING"
                            },
                            {
                                "Name": "unmapped_request_parameters",
                                "Type": "STRING"
                            },
                            {
                                "Name": "unmapped_recipient_account_id",
                                "Type": "STRING"
                            },
                            {
                                "Name": "unmapped_event_type",
                                "Type": "STRING"
                            },
                            {
                                "Name": "unmapped_management_event",
                                "Type": "STRING"
                            },
                            {
                                "Name": "unmapped_read_only",
                                "Type": "STRING"
                            },
                            {
                                "Name": "unmapped_additional_signature_version",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_cipher_suit",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_auth_method",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_sse_applied",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_bytes_tx_in",
                                "Type": "DECIMAL"
                            },
                            {
                                "Name": "unmapped_additional_bytes_tx_out",
                                "Type": "DECIMAL"
                            },
                            {
                                "Name": "unmapped_additional_bucket_name",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_host",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_key",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_function_name",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_invocation_type",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_log_type",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_role_arn",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_session_name",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_duration_sec",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_encryption_algorithm",
                                "Type": "JSON"
                            },
                            {
                                "Name": "unmapped_additional_encryption_context",
                                "Type": "JSON"
                            }
                        ]
                    }
                }
            },
            "LogicalTableMap": {
                "9a10b0b4-f6d8-4285-9247-b8a3a6ba3490": {
                    "Alias": "New custom SQL",
                    "DataTransforms": [
                        {
                            "TagColumnOperation": {
                                "ColumnName": "region",
                                "Tags": [
                                    {
                                        "ColumnGeographicRole": "STATE"
                                    }
                                ]
                            }
                        },
                        {
                            "ProjectOperation": {
                                "ProjectedColumns": [
                                    "Date",
                                    "region",
                                    "user_agent",
                                    "api_response_error",
                                    "api_response_message",
                                    "api_operation",
                                    "api_request_uid",
                                    "api_service_name",
                                    "src_endpoint_uid",
                                    "src_endpoint_ip",
                                    "src_endpoint_domain",
                                    "identity_user_type",
                                    "identity_user_name",
                                    "identity_user_uid",
                                    "identity_user_uuid",
                                    "identity_user_credential_uid",
                                    "account_uid",
                                    "identity_session_created_time",
                                    "identity_session_mfa",
                                    "identity_session_issuer",
                                    "identity_idp",
                                    "unmapped_event_category",
                                    "unmapped_response_element",
                                    "unmapped_request_parameters",
                                    "unmapped_recipient_account_id",
                                    "unmapped_event_type",
                                    "unmapped_management_event",
                                    "unmapped_read_only",
                                    "unmapped_additional_signature_version",
                                    "unmapped_additional_cipher_suit",
                                    "unmapped_additional_auth_method",
                                    "unmapped_additional_sse_applied",
                                    "unmapped_additional_bytes_tx_in",
                                    "unmapped_additional_bytes_tx_out",
                                    "unmapped_additional_bucket_name",
                                    "unmapped_additional_host",
                                    "unmapped_additional_key",
                                    "unmapped_additional_function_name",
                                    "unmapped_additional_invocation_type",
                                    "unmapped_additional_log_type",
                                    "unmapped_additional_role_arn",
                                    "unmapped_additional_session_name",
                                    "unmapped_additional_duration_sec",
                                    "unmapped_additional_encryption_algorithm",
                                    "unmapped_additional_encryption_context"
                                ]
                            }
                        }
                    ],
                    "Source": {
                        "PhysicalTableId": "38dcdd2c-a830-4ca0-be5b-d318dd809351"
                    }
                }
            },
            "OutputColumns": [
                {
                    "Name": "Date",
                    "Type": "DATETIME"
                },
                {
                    "Name": "region",
                    "Type": "STRING"
                },
                {
                    "Name": "user_agent",
                    "Type": "STRING"
                },
                {
                    "Name": "api_response_error",
                    "Type": "STRING"
                },
                {
                    "Name": "api_response_message",
                    "Type": "STRING"
                },
                {
                    "Name": "api_operation",
                    "Type": "STRING"
                },
                {
                    "Name": "api_request_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "api_service_name",
                    "Type": "STRING"
                },
                {
                    "Name": "src_endpoint_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "src_endpoint_ip",
                    "Type": "STRING"
                },
                {
                    "Name": "src_endpoint_domain",
                    "Type": "STRING"
                },
                {
                    "Name": "identity_user_type",
                    "Type": "STRING"
                },
                {
                    "Name": "identity_user_name",
                    "Type": "STRING"
                },
                {
                    "Name": "identity_user_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "identity_user_uuid",
                    "Type": "STRING"
                },
                {
                    "Name": "identity_user_credential_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "account_uid",
                    "Type": "STRING"
                },
                {
                    "Name": "identity_session_created_time",
                    "Type": "INTEGER"
                },
                {
                    "Name": "identity_session_mfa",
                    "Type": "INTEGER"
                },
                {
                    "Name": "identity_session_issuer",
                    "Type": "STRING"
                },
                {
                    "Name": "identity_idp",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_event_category",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_response_element",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_request_parameters",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_recipient_account_id",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_event_type",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_management_event",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_read_only",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_signature_version",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_cipher_suit",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_auth_method",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_sse_applied",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_bytes_tx_in",
                    "Type": "DECIMAL"
                },
                {
                    "Name": "unmapped_additional_bytes_tx_out",
                    "Type": "DECIMAL"
                },
                {
                    "Name": "unmapped_additional_bucket_name",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_host",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_key",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_function_name",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_invocation_type",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_log_type",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_role_arn",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_session_name",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_duration_sec",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_encryption_algorithm",
                    "Type": "STRING"
                },
                {
                    "Name": "unmapped_additional_encryption_context",
                    "Type": "STRING"
                }
            ],
            "ImportMode": "SPICE",
            "ConsumedSpiceCapacityInBytes": 0,
            "FieldFolders": {},
            "DataSetUsageConfiguration": {
                "DisableUseAsDirectQuerySource": false,
                "DisableUseAsImportedSource": false
            },
            "RefreshSchedules": [
                {
                    "ScheduleId": "42118707-6b79-43d5-904c-5d3f7a40231a",
                    "ScheduleFrequency": {
                        "Interval": "DAILY",
                        "Timezone": "America/New_York",
                        "TimeOfTheDay": "23:59"
                    },
                    "StartAfterDateTime": "2023-04-21T15:58:51-04:00",
                    "RefreshType": "FULL_REFRESH"
                }
            ],
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSet",
                        "quicksight:DescribeDataSetPermissions",
                        "quicksight:PassDataSet",
                        "quicksight:DescribeIngestion",
                        "quicksight:ListIngestions"
                    ]
                }
            ]
        },
        "sh-findings-dataset": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/sh-findings-dataset",
            "DataSetId": "sh-findings-dataset",
            "Name": "sh-findings-data",
            "LastUpdatedTime": "2023-05-09T00:00:25.280000-04:00",
            "PhysicalTableMap": {
                "dff4c744-722d-470d-a7b2-3d10ac26d7a6": {
                    "CustomSql": {
                        "DataSourceArn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/sh-findings-datasource",
                        "Name": "New custom SQL",
                        "SqlQuery": "SELECT  \r\n    cast(from_unixtime(time/1000) as timestamp) as Date,\r\n    state,\r\n    region,\r\n    accountid,\r\n    confidence,\r\n    finding.created_time,\r\n    finding.uid,\r\n    finding.desc,\r\n    finding.title,\r\n    finding.modified_time,\r\n    finding.last_seen_time,\r\n    finding.related_events,\r\n    finding.types,\r\n    finding.remediation.kb_articles,\r\n    finding.src_url,\r\n    compliance.status,\r\n    compliance.requirements,\r\n    compliance.status_detail,\r\n    malware,\r\n    vulnerabilities,\r\n    unmapped['Severity_Normalized'] as Severity_Normalized,\r\n    unmapped['Severity_Original'] as Severity_Original,\r\n    unmapped['CompanyName'] as CompanyName,\r\n    unmapped['Severity'] as Severity,\r\n    unmapped['RecordState'] as RecordState,\r\n    unmapped['Severity_Product'] as Severity_Product\r\n    FROM \"amazon_security_lake_glue_db_<aws-security-lake-region>\".\"amazon_security_lake_table_<aws-security-lake-region>_sh_findings_1_0_1_0\"\r\n    WHERE eventDay >= cast(date_format(current_timestamp - INTERVAL '6' month, '%Y%m%d%H') as varchar)",
                        "Columns": [
                            {
                                "Name": "Date",
                                "Type": "DATETIME"
                            },
                            {
                                "Name": "state",
                                "Type": "STRING"
                            },
                            {
                                "Name": "region",
                                "Type": "STRING"
                            },
                            {
                                "Name": "accountid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "confidence",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "created_time",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "uid",
                                "Type": "STRING"
                            },
                            {
                                "Name": "desc",
                                "Type": "STRING"
                            },
                            {
                                "Name": "title",
                                "Type": "STRING"
                            },
                            {
                                "Name": "modified_time",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "last_seen_time",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "src_url",
                                "Type": "STRING"
                            },
                            {
                                "Name": "status",
                                "Type": "STRING"
                            },
                            {
                                "Name": "status_detail",
                                "Type": "STRING"
                            },
                            {
                                "Name": "Severity_Normalized",
                                "Type": "STRING"
                            },
                            {
                                "Name": "Severity_Original",
                                "Type": "STRING"
                            },
                            {
                                "Name": "CompanyName",
                                "Type": "STRING"
                            },
                            {
                                "Name": "Severity",
                                "Type": "STRING"
                            },
                            {
                                "Name": "RecordState",
                                "Type": "STRING"
                            },
                            {
                                "Name": "Severity_Product",
                                "Type": "STRING"
                            }
                        ]
                    }
                }
            },
            "LogicalTableMap": {
                "6ab7340b-ead7-4155-a74b-3d7bdb12914f": {
                    "Alias": "New custom SQL",
                    "DataTransforms": [
                        {
                            "ProjectOperation": {
                                "ProjectedColumns": [
                                    "Date",
                                    "state",
                                    "region",
                                    "accountid",
                                    "confidence",
                                    "created_time",
                                    "uid",
                                    "desc",
                                    "title",
                                    "modified_time",
                                    "last_seen_time",
                                    "src_url",
                                    "status",
                                    "status_detail",
                                    "Severity_Normalized",
                                    "Severity_Original",
                                    "CompanyName",
                                    "Severity",
                                    "RecordState",
                                    "Severity_Product"
                                ]
                            }
                        }
                    ],
                    "Source": {
                        "PhysicalTableId": "dff4c744-722d-470d-a7b2-3d10ac26d7a6"
                    }
                }
            },
            "OutputColumns": [
                {
                    "Name": "Date",
                    "Type": "DATETIME"
                },
                {
                    "Name": "state",
                    "Type": "STRING"
                },
                {
                    "Name": "region",
                    "Type": "STRING"
                },
                {
                    "Name": "accountid",
                    "Type": "STRING"
                },
                {
                    "Name": "confidence",
                    "Type": "INTEGER"
                },
                {
                    "Name": "created_time",
                    "Type": "INTEGER"
                },
                {
                    "Name": "uid",
                    "Type": "STRING"
                },
                {
                    "Name": "desc",
                    "Type": "STRING"
                },
                {
                    "Name": "title",
                    "Type": "STRING"
                },
                {
                    "Name": "modified_time",
                    "Type": "INTEGER"
                },
                {
                    "Name": "last_seen_time",
                    "Type": "INTEGER"
                },
                {
                    "Name": "src_url",
                    "Type": "STRING"
                },
                {
                    "Name": "status",
                    "Type": "STRING"
                },
                {
                    "Name": "status_detail",
                    "Type": "STRING"
                },
                {
                    "Name": "Severity_Normalized",
                    "Type": "STRING"
                },
                {
                    "Name": "Severity_Original",
                    "Type": "STRING"
                },
                {
                    "Name": "CompanyName",
                    "Type": "STRING"
                },
                {
                    "Name": "Severity",
                    "Type": "STRING"
                },
                {
                    "Name": "RecordState",
                    "Type": "STRING"
                },
                {
                    "Name": "Severity_Product",
                    "Type": "STRING"
                }
            ],
            "ImportMode": "SPICE",
            "ConsumedSpiceCapacityInBytes": 4595308,
            "FieldFolders": {},
            "DataSetUsageConfiguration": {
                "DisableUseAsDirectQuerySource": false,
                "DisableUseAsImportedSource": false
            },
            "RefreshSchedules": [
                {
                    "ScheduleId": "412892ed-752a-447e-8fb0-62c1ae129b05",
                    "ScheduleFrequency": {
                        "Interval": "DAILY",
                        "Timezone": "America/New_York",
                        "TimeOfTheDay": "23:59"
                    },
                    "StartAfterDateTime": "2023-04-21T15:58:54-04:00",
                    "RefreshType": "FULL_REFRESH"
                }
            ],
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSet",
                        "quicksight:DescribeDataSetPermissions",
                        "quicksight:PassDataSet",
                        "quicksight:DescribeIngestion",
                        "quicksight:ListIngestions"
                    ]
                }
            ]
        },
        "r53-dataset": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/r53-dataset",
            "DataSetId": "r53-dataset",
            "Name": "route-53-data",
            "LastUpdatedTime": "2023-05-09T00:01:16.411000-04:00",
            "PhysicalTableMap": {
                "19e59f5a-6a08-45d6-a852-d89ee6b3a349": {
                    "CustomSql": {
                        "DataSourceArn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/r53-datasource",
                        "Name": "New custom SQL",
                        "SqlQuery": "with d as (\r\n    select \r\n        uuid() as recordId,\r\n        cast(from_unixtime(time/1000) as timestamp) as Date,\r\n        metadata.product.name as product,\r\n        metadata.product.feature.name as feature,\r\n        cloud.account_uid as accountId,\r\n        cloud.region as region,\r\n        cloud.provider as provider,\r\n        src_endpoint.vpc_uid as srcVpc,\r\n        src_endpoint.ip as srcIp,\r\n        cast(src_endpoint.port AS varchar) as src_endpoint_port,\r\n        src_endpoint.instance_uid as srcInstance,\r\n        dst_endpoint.instance_uid as dstInstance,\r\n        dst_endpoint.interface_uid as dstInterface,\r\n        connection_info.protocol_name as protocolName,\r\n        connection_info.direction as protocolDirection,\r\n        connection_info.direction_id as protocolDirectionId,\r\n        class_name as className,\r\n        category_name as categoryName,\r\n        severity,\r\n        activity_name as activityName,\r\n        type_name as typeName,\r\n        rcode as rCode, \r\n        query.hostname as queryHostname,\r\n        query.type as queryType,\r\n        query.class as queryClass,\r\n        cardinality(answers) as answersCount,\r\n        case when cardinality(answers) = 0 then ARRAY[null] else answers end answers\r\n    FROM amazon_security_lake_glue_db_<aws-security-lake-region>.amazon_security_lake_table_<aws-security-lake-region>_route53_1_0 as r53\r\n    WHERE eventDay >= cast(date_format(current_timestamp - INTERVAL '6' month, '%Y%m%d%H') as varchar)\r\n) select\r\n    *, \r\n    case when answer is null then null else answer.type end as rType, \r\n    case when answer is null then null else answer.class end as rClass,\r\n    case when answer is null then null else answer.rData end as rData\r\nfrom d, unnest(answers) as t(answer)",
                        "Columns": [
                            {
                                "Name": "recordId",
                                "Type": "STRING"
                            },
                            {
                                "Name": "Date",
                                "Type": "DATETIME"
                            },
                            {
                                "Name": "product",
                                "Type": "STRING"
                            },
                            {
                                "Name": "feature",
                                "Type": "STRING"
                            },
                            {
                                "Name": "accountId",
                                "Type": "STRING"
                            },
                            {
                                "Name": "region",
                                "Type": "STRING"
                            },
                            {
                                "Name": "provider",
                                "Type": "STRING"
                            },
                            {
                                "Name": "srcVpc",
                                "Type": "STRING"
                            },
                            {
                                "Name": "srcIp",
                                "Type": "STRING"
                            },
                            {
                                "Name": "src_endpoint_port",
                                "Type": "STRING"
                            },
                            {
                                "Name": "srcInstance",
                                "Type": "STRING"
                            },
                            {
                                "Name": "dstInstance",
                                "Type": "STRING"
                            },
                            {
                                "Name": "dstInterface",
                                "Type": "STRING"
                            },
                            {
                                "Name": "protocolName",
                                "Type": "STRING"
                            },
                            {
                                "Name": "protocolDirection",
                                "Type": "STRING"
                            },
                            {
                                "Name": "protocolDirectionId",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "className",
                                "Type": "STRING"
                            },
                            {
                                "Name": "categoryName",
                                "Type": "STRING"
                            },
                            {
                                "Name": "severity",
                                "Type": "STRING"
                            },
                            {
                                "Name": "activityName",
                                "Type": "STRING"
                            },
                            {
                                "Name": "typeName",
                                "Type": "STRING"
                            },
                            {
                                "Name": "rCode",
                                "Type": "STRING"
                            },
                            {
                                "Name": "queryHostname",
                                "Type": "STRING"
                            },
                            {
                                "Name": "queryType",
                                "Type": "STRING"
                            },
                            {
                                "Name": "queryClass",
                                "Type": "STRING"
                            },
                            {
                                "Name": "answersCount",
                                "Type": "INTEGER"
                            },
                            {
                                "Name": "answer",
                                "Type": "STRING"
                            },
                            {
                                "Name": "rType",
                                "Type": "STRING"
                            },
                            {
                                "Name": "rClass",
                                "Type": "STRING"
                            },
                            {
                                "Name": "rData",
                                "Type": "STRING"
                            }
                        ]
                    }
                }
            },
            "LogicalTableMap": {
                "0ddebb26-5cb8-4a96-ad8d-1f833d297908": {
                    "Alias": "New custom SQL",
                    "DataTransforms": [
                        {
                            "TagColumnOperation": {
                                "ColumnName": "region",
                                "Tags": [
                                    {
                                        "ColumnGeographicRole": "STATE"
                                    }
                                ]
                            }
                        },
                        {
                            "ProjectOperation": {
                                "ProjectedColumns": [
                                    "recordId",
                                    "Date",
                                    "product",
                                    "feature",
                                    "accountId",
                                    "region",
                                    "provider",
                                    "srcVpc",
                                    "srcIp",
                                    "src_endpoint_port",
                                    "srcInstance",
                                    "dstInstance",
                                    "dstInterface",
                                    "protocolName",
                                    "protocolDirection",
                                    "protocolDirectionId",
                                    "className",
                                    "categoryName",
                                    "severity",
                                    "activityName",
                                    "typeName",
                                    "rCode",
                                    "queryHostname",
                                    "queryType",
                                    "queryClass",
                                    "answersCount",
                                    "answer",
                                    "rType",
                                    "rClass",
                                    "rData"
                                ]
                            }
                        }
                    ],
                    "Source": {
                        "PhysicalTableId": "19e59f5a-6a08-45d6-a852-d89ee6b3a349"
                    }
                }
            },
            "OutputColumns": [
                {
                    "Name": "recordId",
                    "Type": "STRING"
                },
                {
                    "Name": "Date",
                    "Type": "DATETIME"
                },
                {
                    "Name": "product",
                    "Type": "STRING"
                },
                {
                    "Name": "feature",
                    "Type": "STRING"
                },
                {
                    "Name": "accountId",
                    "Type": "STRING"
                },
                {
                    "Name": "region",
                    "Type": "STRING"
                },
                {
                    "Name": "provider",
                    "Type": "STRING"
                },
                {
                    "Name": "srcVpc",
                    "Type": "STRING"
                },
                {
                    "Name": "srcIp",
                    "Type": "STRING"
                },
                {
                    "Name": "src_endpoint_port",
                    "Type": "STRING"
                },
                {
                    "Name": "srcInstance",
                    "Type": "STRING"
                },
                {
                    "Name": "dstInstance",
                    "Type": "STRING"
                },
                {
                    "Name": "dstInterface",
                    "Type": "STRING"
                },
                {
                    "Name": "protocolName",
                    "Type": "STRING"
                },
                {
                    "Name": "protocolDirection",
                    "Type": "STRING"
                },
                {
                    "Name": "protocolDirectionId",
                    "Type": "INTEGER"
                },
                {
                    "Name": "className",
                    "Type": "STRING"
                },
                {
                    "Name": "categoryName",
                    "Type": "STRING"
                },
                {
                    "Name": "severity",
                    "Type": "STRING"
                },
                {
                    "Name": "activityName",
                    "Type": "STRING"
                },
                {
                    "Name": "typeName",
                    "Type": "STRING"
                },
                {
                    "Name": "rCode",
                    "Type": "STRING"
                },
                {
                    "Name": "queryHostname",
                    "Type": "STRING"
                },
                {
                    "Name": "queryType",
                    "Type": "STRING"
                },
                {
                    "Name": "queryClass",
                    "Type": "STRING"
                },
                {
                    "Name": "answersCount",
                    "Type": "INTEGER"
                },
                {
                    "Name": "answer",
                    "Type": "STRING"
                },
                {
                    "Name": "rType",
                    "Type": "STRING"
                },
                {
                    "Name": "rClass",
                    "Type": "STRING"
                },
                {
                    "Name": "rData",
                    "Type": "STRING"
                }
            ],
            "ImportMode": "SPICE",
            "ConsumedSpiceCapacityInBytes": 642279,
            "FieldFolders": {},
            "DataSetUsageConfiguration": {
                "DisableUseAsDirectQuerySource": false,
                "DisableUseAsImportedSource": false
            },
            "RefreshSchedules": [
                {
                    "ScheduleId": "fbb9fe52-a3a7-43a8-920b-82acdd8833c6",
                    "ScheduleFrequency": {
                        "Interval": "DAILY",
                        "Timezone": "America/New_York",
                        "TimeOfTheDay": "23:59"
                    },
                    "StartAfterDateTime": "2023-04-21T15:58:56-04:00",
                    "RefreshType": "FULL_REFRESH"
                }
            ],
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSet",
                        "quicksight:DescribeDataSetPermissions",
                        "quicksight:PassDataSet",
                        "quicksight:DescribeIngestion",
                        "quicksight:ListIngestions"
                    ]
                }
            ]
        },
        "sl-ag-dataset": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:dataset/sl-ag-dataset",
            "DataSetId": "sl-ag-dataset",
            "Name": "sl-ag-production",
            "LastUpdatedTime": "2023-05-09T00:21:39.461000-04:00",
            "PhysicalTableMap": {
                "f847f94d-2919-41a3-9857-f611cbbabcb4": {
                    "CustomSql": {
                        "DataSourceArn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/sl-ag-datasource",
                        "Name": "New custom SQL",
                        "SqlQuery": "WITH cloud_trail as\r\n    (select\r\n       cast(from_unixtime(time/1000) as timestamp) as Date,\r\n        class_name, activity_name, region, accountid\r\n    FROM amazon_security_lake_glue_db_<aws-security-lake-region>.amazon_security_lake_table_<aws-security-lake-region>_cloud_trail_mgmt_1_0_1_0\r\n    WHERE  eventDay >= cast(date_format(current_timestamp - INTERVAL '6' month, '%Y%m%d%H') as varchar)\r\n    ),\r\nroute53 as\r\n    (select\r\n        cast(from_unixtime(time/1000) as timestamp) as Date,\r\n        class_name, activity_name, region, accountid\r\n    FROM amazon_security_lake_glue_db_<aws-security-lake-region>.amazon_security_lake_table_<aws-security-lake-region>_route53_1_0\r\n    WHERE eventDay >= cast(date_format(current_timestamp - INTERVAL '6' month, '%Y%m%d%H') as varchar)\r\n    ),\r\nsh_findings as\r\n    (select\r\n        cast(from_unixtime(time/1000) as timestamp) as Date,\r\n        class_name, activity_name, region, accountid\r\n    FROM amazon_security_lake_glue_db_<aws-security-lake-region>.amazon_security_lake_table_<aws-security-lake-region>_sh_findings_1_0_1_0\r\n    WHERE eventDay >= cast(date_format(current_timestamp - INTERVAL '6' month, '%Y%m%d%H') as varchar)\r\n    ),\r\nvpc_flow as\r\n    (select\r\n        cast(from_unixtime(time/1000) as timestamp) as Date,\r\n        class_name, activity_name, region, accountid\r\n    FROM amazon_security_lake_glue_db_<aws-security-lake-region>.amazon_security_lake_table_<aws-security-lake-region>_vpc_flow_1_0_1_0\r\n    WHERE eventDay >= cast(date_format(current_timestamp - INTERVAL '6' month, '%Y%m%d%H') as varchar)\r\n    )\r\nselect * from cloud_trail\r\nunion all\r\nselect * from route53\r\nunion all\r\nselect * from sh_findings\r\nunion all\r\nselect * from vpc_flow",
                        "Columns": [
                            {
                                "Name": "Date",
                                "Type": "DATETIME"
                            },
                            {
                                "Name": "class_name",
                                "Type": "STRING"
                            },
                            {
                                "Name": "activity_name",
                                "Type": "STRING"
                            },
                            {
                                "Name": "region",
                                "Type": "STRING"
                            },
                            {
                                "Name": "accountid",
                                "Type": "STRING"
                            }
                        ]
                    }
                }
            },
            "LogicalTableMap": {
                "d4c839f4-b487-41ec-bbe7-0b1873d3c22c": {
                    "Alias": "New custom SQL",
                    "DataTransforms": [
                        {
                            "TagColumnOperation": {
                                "ColumnName": "region",
                                "Tags": [
                                    {
                                        "ColumnGeographicRole": "STATE"
                                    }
                                ]
                            }
                        },
                        {
                            "ProjectOperation": {
                                "ProjectedColumns": [
                                    "Date",
                                    "class_name",
                                    "activity_name",
                                    "region",
                                    "accountid"
                                ]
                            }
                        }
                    ],
                    "Source": {
                        "PhysicalTableId": "f847f94d-2919-41a3-9857-f611cbbabcb4"
                    }
                }
            },
            "OutputColumns": [
                {
                    "Name": "Date",
                    "Type": "DATETIME"
                },
                {
                    "Name": "class_name",
                    "Type": "STRING"
                },
                {
                    "Name": "activity_name",
                    "Type": "STRING"
                },
                {
                    "Name": "region",
                    "Type": "STRING"
                },
                {
                    "Name": "accountid",
                    "Type": "STRING"
                }
            ],
            "ImportMode": "SPICE",
            "ConsumedSpiceCapacityInBytes": 55486177,
            "FieldFolders": {},
            "DataSetUsageConfiguration": {
                "DisableUseAsDirectQuerySource": false,
                "DisableUseAsImportedSource": false
            },
            "RefreshSchedules": [
                {
                    "ScheduleId": "44ce0eab-79f8-4b57-9a22-68daef8b49bc",
                    "ScheduleFrequency": {
                        "Interval": "DAILY",
                        "Timezone": "America/New_York",
                        "TimeOfTheDay": "23:59"
                    },
                    "StartAfterDateTime": "2023-04-21T15:58:58-04:00",
                    "RefreshType": "FULL_REFRESH"
                }
            ],
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSet",
                        "quicksight:DescribeDataSetPermissions",
                        "quicksight:PassDataSet",
                        "quicksight:DescribeIngestion",
                        "quicksight:ListIngestions"
                    ]
                }
            ]
        }
    },
    "datasources": {
        "vpc-flow-datasource": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/vpc-flow-datasource",
            "DataSourceId": "vpc-flow-datasource",
            "Name": "amazon_security_lake_glue_db_<aws-security-lake-region>",
            "Type": "ATHENA",
            "LastUpdatedTime": "2023-04-21T15:58:43.524000-04:00",
            "DataSourceParameters": {
                "AthenaParameters": {
                    "WorkGroup": "primary"
                }
            },
            "SslProperties": {
                "DisableSsl": false
            },
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSource",
                        "quicksight:DescribeDataSourcePermissions",
                        "quicksight:PassDataSource"
                    ]
                }
            ]
        },
        "cloudtrail-datasource": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/cloudtrail-datasource",
            "DataSourceId": "cloudtrail-datasource",
            "Name": "amazon_security_lake_glue_db_<aws-security-lake-region>",
            "Type": "ATHENA",
            "LastUpdatedTime": "2023-04-21T15:58:43.523000-04:00",
            "DataSourceParameters": {
                "AthenaParameters": {
                    "WorkGroup": "primary"
                }
            },
            "SslProperties": {
                "DisableSsl": false
            },
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSource",
                        "quicksight:DescribeDataSourcePermissions",
                        "quicksight:PassDataSource"
                    ]
                }
            ]
        },
        "sh-findings-datasource": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/sh-findings-datasource",
            "DataSourceId": "sh-findings-datasource",
            "Name": "amazon_security_lake_glue_db_<aws-security-lake-region>",
            "Type": "ATHENA",
            "LastUpdatedTime": "2023-04-21T15:58:43.954000-04:00",
            "DataSourceParameters": {
                "AthenaParameters": {
                    "WorkGroup": "primary"
                }
            },
            "SslProperties": {
                "DisableSsl": false
            },
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSource",
                        "quicksight:DescribeDataSourcePermissions",
                        "quicksight:PassDataSource"
                    ]
                }
            ]
        },
        "r53-datasource": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/r53-datasource",
            "DataSourceId": "r53-datasource",
            "Name": "amazon_security_lake_glue_db_<aws-security-lake-region>",
            "Type": "ATHENA",
            "LastUpdatedTime": "2023-04-21T15:58:49.068000-04:00",
            "DataSourceParameters": {
                "AthenaParameters": {
                    "WorkGroup": "primary"
                }
            },
            "SslProperties": {
                "DisableSsl": false
            },
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSource",
                        "quicksight:DescribeDataSourcePermissions",
                        "quicksight:PassDataSource"
                    ]
                }
            ]
        },
        "sl-ag-datasource": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:datasource/sl-ag-datasource",
            "DataSourceId": "sl-ag-datasource",
            "Name": "amazon_security_lake_glue_db_<aws-security-lake-region>",
            "Type": "ATHENA",
            "LastUpdatedTime": "2023-04-21T15:58:44.614000-04:00",
            "DataSourceParameters": {
                "AthenaParameters": {
                    "WorkGroup": "primary"
                }
            },
            "SslProperties": {
                "DisableSsl": false
            },
            "Permissions": [
                {
                    "Principal": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
                    "Actions": [
                        "quicksight:DescribeDataSource",
                        "quicksight:DescribeDataSourcePermissions",
                        "quicksight:PassDataSource"
                    ]
                }
            ]
        }
    },
    "groups": {
        "security-lake-operator-group": {
            "Arn": "arn:aws:quicksight:<aws-region>:<aws-account>:group/default/security-lake-operator-group",
            "GroupName": "security-lake-operator-group",
            "Description": "security-lake-operator-group",
            "PrincipalId": "group/d-9067a6eb92/f2aba374-9166-4664-bf46-07bfc1e0f5f3"
        }
    }
}
